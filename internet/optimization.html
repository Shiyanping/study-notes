<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端学习笔记及思维导图 | 性能优化</title>
    <meta name="description" content="总结前端学习过程中的笔记，根据自己的思维结构画出脑海中的思维导图，有助于学习前端知识。">
    <link rel="icon" href="/study-notes/logo.jpg">
    
    <link rel="preload" href="/study-notes/assets/css/40.styles.674d4f45.css" as="style"><link rel="preload" href="/study-notes/assets/js/app.403b6997.js" as="script"><link rel="preload" href="/study-notes/assets/js/23.4eed920c.js" as="script"><link rel="prefetch" href="/study-notes/assets/js/19.122c00dd.js"><link rel="prefetch" href="/study-notes/assets/js/0.a48ab10b.js"><link rel="prefetch" href="/study-notes/assets/js/1.728eb2ad.js"><link rel="prefetch" href="/study-notes/assets/js/2.67160c25.js"><link rel="prefetch" href="/study-notes/assets/js/3.d8d9a108.js"><link rel="prefetch" href="/study-notes/assets/js/4.e8551997.js"><link rel="prefetch" href="/study-notes/assets/js/5.a02d4e5d.js"><link rel="prefetch" href="/study-notes/assets/js/6.d95f122c.js"><link rel="prefetch" href="/study-notes/assets/js/7.1a0fe8cc.js"><link rel="prefetch" href="/study-notes/assets/js/8.e661f840.js"><link rel="prefetch" href="/study-notes/assets/js/9.9c0ba153.js"><link rel="prefetch" href="/study-notes/assets/js/10.890e7606.js"><link rel="prefetch" href="/study-notes/assets/js/11.cc0a35b6.js"><link rel="prefetch" href="/study-notes/assets/js/12.f833d50f.js"><link rel="prefetch" href="/study-notes/assets/js/13.e3c335c5.js"><link rel="prefetch" href="/study-notes/assets/js/14.cb2749b8.js"><link rel="prefetch" href="/study-notes/assets/js/15.ded5c853.js"><link rel="prefetch" href="/study-notes/assets/js/16.e6368c73.js"><link rel="prefetch" href="/study-notes/assets/js/17.cbce4206.js"><link rel="prefetch" href="/study-notes/assets/js/18.7f1c5db3.js"><link rel="prefetch" href="/study-notes/assets/js/20.4ca54c11.js"><link rel="prefetch" href="/study-notes/assets/js/21.a0dc2a02.js"><link rel="prefetch" href="/study-notes/assets/js/22.ef8b4e2f.js"><link rel="prefetch" href="/study-notes/assets/js/24.b5cc3303.js"><link rel="prefetch" href="/study-notes/assets/js/25.c4fe71d5.js"><link rel="prefetch" href="/study-notes/assets/js/26.108f8891.js"><link rel="prefetch" href="/study-notes/assets/js/27.3a82b22e.js"><link rel="prefetch" href="/study-notes/assets/js/28.9037a9da.js"><link rel="prefetch" href="/study-notes/assets/js/29.173185b0.js"><link rel="prefetch" href="/study-notes/assets/js/30.853bb732.js"><link rel="prefetch" href="/study-notes/assets/js/31.0511c245.js"><link rel="prefetch" href="/study-notes/assets/js/32.33565ee9.js"><link rel="prefetch" href="/study-notes/assets/js/33.79db5533.js"><link rel="prefetch" href="/study-notes/assets/js/34.baf0685a.js"><link rel="prefetch" href="/study-notes/assets/js/35.2f3d2102.js"><link rel="prefetch" href="/study-notes/assets/js/36.f97a3af3.js"><link rel="prefetch" href="/study-notes/assets/js/37.82254956.js"><link rel="prefetch" href="/study-notes/assets/js/38.6eee7d87.js"><link rel="prefetch" href="/study-notes/assets/js/39.bd696d87.js">
    <link rel="stylesheet" href="/study-notes/assets/css/40.styles.674d4f45.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/study-notes/" class="home-link router-link-active"><!----><span class="site-name">
      前端学习笔记及思维导图
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="http://www.shiyanping.top/" target="_blank" rel="noopener noreferrer" class="nav-link">博客</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">我的相关</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="http://www.shiyanping.top//resume/" target="_blank" rel="noopener noreferrer" class="nav-link">简历</a></li><li class="dropdown-item"><!----><a href="http://www.shiyanping.top/fe-tool" target="_blank" rel="noopener noreferrer" class="nav-link">前端工具集</a></li></ul></div></div><a href="https://github.com/Shiyanping/study-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://www.shiyanping.top/" target="_blank" rel="noopener noreferrer" class="nav-link">博客</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">我的相关</span><span class="arrow right"></span></a><ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----><a href="http://www.shiyanping.top//resume/" target="_blank" rel="noopener noreferrer" class="nav-link">简历</a></li><li class="dropdown-item"><!----><a href="http://www.shiyanping.top/fe-tool" target="_blank" rel="noopener noreferrer" class="nav-link">前端工具集</a></li></ul></div></div><a href="https://github.com/Shiyanping/study-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>你不知道的 JavaScript</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS 的世界</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>HTML</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Vue</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>服务器端常识</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Node 半知半解</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>世界上最好的语言 PHP</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>网络协议</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/study-notes/internet/http.html" class="sidebar-link">HTTP 那些事</a></li><li><a href="/study-notes/internet/optimization.html" class="active sidebar-link">性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/study-notes/internet/optimization.html#_1-请求过程" class="sidebar-link">1. 请求过程</a></li><li class="sidebar-sub-header"><a href="/study-notes/internet/optimization.html#_2-dns-解析" class="sidebar-link">2. DNS 解析</a></li><li class="sidebar-sub-header"><a href="/study-notes/internet/optimization.html#_3-tcp-三次握手和四次挥手" class="sidebar-link">3. TCP 三次握手和四次挥手</a></li><li class="sidebar-sub-header"><a href="/study-notes/internet/optimization.html#_4-浏览器缓存机制" class="sidebar-link">4. 浏览器缓存机制</a></li></ul></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>浏览器知识</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>自动化测试</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>性能优化</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>工程化</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>软件工程学</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="性能优化"><a href="#性能优化" aria-hidden="true" class="header-anchor">#</a> 性能优化</h1><h2 id="_1-请求过程"><a href="#_1-请求过程" aria-hidden="true" class="header-anchor">#</a> 1. 请求过程</h2><p><strong>输入网页之后的整个流程：</strong></p><ol><li>浏览器输入用户需要访问的域名</li><li>DNS 将输入域名解析成 IP</li><li>通过 IP 找到指定的机器或者集群</li><li>反向代理通过负载均衡找到最好的机器</li><li>服务器处理请求，返回数据</li><li>浏览器处理请求</li></ol><p>上面只是大致的网络请求资源的过程，其实底层的操作会更多，引用 W3C 里的一张图：</p><p><img src="http://cdn.jinyueyue.cn/15516052836980.jpg" alt></p><ol><li><p>如果有旧的页面，就将旧的页面进行卸载。</p></li><li><p>页面跳转，重定向。</p></li><li><p>如果做了缓存，会查找缓存是否存在（优化的效果最大），带宽有限，重复性的资源可以使用缓存，减少带宽的压力。</p></li><li><p>DNS（UDP 协议）解析域名。</p></li><li><p>TCP 建立连接，在做性能优化时，TCP 可以使用长连接（keep-live）进行优化，减少三次握手和四次挥手的时间。</p></li><li><p>浏览器发出请求（request）。</p></li><li><p>服务器处理响应（response）。</p></li><li><p>浏览器处理服务器返回的资源，刚接收到服务器返回的资源时，其实是一个文本文件，将文本文件解析成 HTML，然后处理 dom（domLoading -&gt; domInteractive -&gt; domContentLoaded -&gt; domComplete），一直到 domComplete 之后，dom 树就生成完毕了。</p></li></ol><blockquote><p>webSocket：属于永久链接，和长连接类似。</p><p>事务：从头到尾的一整个流程，如果有一个操作错误，那就代表着整个流程都失败。</p></blockquote><h2 id="_2-dns-解析"><a href="#_2-dns-解析" aria-hidden="true" class="header-anchor">#</a> 2. DNS 解析</h2><p>域名系统，用于将域名转换成 IP，域名和 IP 对应的 key-value。</p><p>顶级域名：shiyanping.com</p><p>二级域名：www.shiyanping.com.cn</p><ol><li>浏览器发起查询，DNS 向根域名服务器（Root Server），TLD Server，Name Server，进行迭代查询。主要由运营商负责自己的 DNS，一般 DNS 都有缓存，为了查找更快，所以我们在换域名之后，一定要更新缓存。</li><li>Root Server：查找具体域名后缀归哪个 TLD Server 服务器管，比如查找.com 后缀的域名归哪个 TLD Server 管。</li><li>TLD Server：保存域名后缀（.com、.cn、.net）</li><li>Name Server：保存具体顶级域名，二级域名，三级域名，找到域名对应的域名</li></ol><h2 id="_3-tcp-三次握手和四次挥手"><a href="#_3-tcp-三次握手和四次挥手" aria-hidden="true" class="header-anchor">#</a> 3. TCP 三次握手和四次挥手</h2><p>TCP 的核心就是要需要建立一条稳定的通信链路，在请求资源的过程中，主要包括建立连接，数据传输，断开连接，TCP 的三次握手主要发生在建立连接的过程中，四次挥手主要发生在断开连接的过程中。</p><p><strong>三次握手：</strong></p><ol><li>客户端发送建连包（SYN），并带上响应号（seq=x）</li><li>服务器接收到客户端的建连包之后做出回应，发出应答包（ACK），同事也发出服务端自己的建连包（SYN）。应答包主要回应客户端，标识服务器接受到了客户端发送的建连包，应答包中必须携带应答号（ACK=x+1），应答号在客户端发出的响应号的基础上+1；同时服务端还要发送一个自己的建连包给客户端，并带上服务端的响应号（SYN seq=y）。</li><li>客户端收到服务端发出的应答包之后，表示自己的建连成功了，但是为了回应服务端的建连，还需要发送一个应答包，客户端的应答包中同样需要携带应答号，应答号是服务端发送响应号+1（ACK=y+1）。</li></ol><p>客户端和服务端都需要来回确认收到包，防止丢包，每次收到包之后，标识都需要+1。</p><p><img src="http://cdn.jinyueyue.cn/15516052971502.jpg" alt></p><p><strong>数据传输：</strong></p><p>将一个大数据拆分成多个小数据包，每个小数据包都有自己的标识，服务端接受到各个小数据包之后，进行组装，如果缺少某个数据包，服务端会向客户端发送一个重新请求的指令。</p><p><img src="http://cdn.jinyueyue.cn/15516053115014.jpg" alt></p><p><strong>四次挥手：</strong></p><ol><li>正常情况下客户端先发起第一次挥手（FIN seq=x+2 ACK=y+1），特殊情况：服务器超时，服务器异常</li><li>服务器接受到挥手请求，服务器发送应答包给客户端，应答客户端的挥手（ACK x+3）。</li><li>服务器向客户端发送挥手请求包，服务端再次发送挥手请求的原因，主要是为了确定自己没做完的工作，客户端还要不要（FIN seq=y+1），释放服务器的内容。</li><li>客户端接收到挥手请求，客户端发送应答包给服务端，彻底关闭数据传输（ACK=y+2）。</li></ol><p><img src="http://cdn.jinyueyue.cn/15516053259057.jpg" alt></p><blockquote><p>单工：单向通信，例：村东头的喇叭</p><p>双工：双向通信</p><p>半双工：例：对讲机，默认是接受状态，讲话的时候按住按钮，同一时间只能执行一件事。</p><p>全双工：例：电话，同一时间接受和发送双向通信都可以。</p><p>seq：响应号</p><p>ACK：应答号</p><p>SYN：建立连接的包</p><p>FIN：断开连接的包</p></blockquote><h2 id="_4-浏览器缓存机制"><a href="#_4-浏览器缓存机制" aria-hidden="true" class="header-anchor">#</a> 4. 浏览器缓存机制</h2><blockquote><p>Expiress：启用缓存，并且告诉缓存时间</p><p>Cache-Control：</p><ol><li>no-cache：不需要缓存</li><li>时间戳：在本地保存多久</li></ol><p>Etag：服务器在相应请求时，给当前资源在服务器打上唯一的标识</p><p>If-None-Match：当资源过期时，发现资源有 Etag</p><p>last-Modified：标识响应资源的最后修改时间</p><p>If-Modified-None</p></blockquote><p>静态资源缓存，动态资源，身份验证的资源不缓存</p></div><div class="content edit-link"><a href="https://github.com/Shiyanping/study-notes/edit/vuepress/docs/internet/optimization.md" target="_blank" rel="noopener noreferrer">欢迎大家来补充</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/study-notes/internet/http.html" class="prev">
          HTTP 那些事
        </a></span><span class="next"><a href="/study-notes/browser/corss-domain.html">
          前端跨域
        </a> →
      </span></p></div></div></div></div>
    <script src="/study-notes/assets/js/23.4eed920c.js" defer></script><script src="/study-notes/assets/js/app.403b6997.js" defer></script>
  </body>
</html>
