(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{78:function(s,t,e){"use strict";e.r(t);var a=e(0),n=Object(a.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"content"},[e("h1",{attrs:{id:"linux-免密登录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux-免密登录","aria-hidden":"true"}},[s._v("#")]),s._v(" Linux 免密登录")]),e("h2",{attrs:{id:"_1-生成秘钥对"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-生成秘钥对","aria-hidden":"true"}},[s._v("#")]),s._v(" 1. 生成秘钥对")]),e("p",[s._v("首先我们需要在自己的本机上生成秘钥对，在任何一个文件夹中都可以，但是最好在自己 home 目录下中的 .ssh 文件夹中进行，这样就可以省掉后续将生成秘钥对移动到这个文件夹的操作。")]),e("p",[s._v("在 mac 上可以通过 "),e("code",[s._v("cd ~/.ssh")]),s._v(" 进入该文件夹，window 的用户自行搜索吧。")]),e("p",[s._v("进入文件夹之后，通过一下命令生成秘钥对：")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("ssh-keygen -t rsa -C "),e("span",{attrs:{class:"token string"}},[s._v('"你自己的名字"')]),s._v(" -f "),e("span",{attrs:{class:"token string"}},[s._v('"你自己的名字_rsa"')]),s._v("\n")])]),e("p",[s._v("生成之后，你会发现多了两个文件，一个是"),e("code",[s._v("你自己的名字_rsa")]),s._v("，一个是"),e("code",[s._v("你自己的名字_rsa.pub")]),s._v("，带 pub 的是公钥，后续需要放到服务器上，不带 pub 的是秘钥，需要放到 "),e("code",[s._v("home/.ssh")]),s._v("下，如果上面你已经进入到这个文件夹中，那我们不需要移动就可以了，如果没进入这个文件夹，那我们就需要将这个秘钥移动到这个文件夹中，可以参考第三步-配置本地秘钥。")]),e("h2",{attrs:{id:"_2-上传配置公钥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-上传配置公钥","aria-hidden":"true"}},[s._v("#")]),s._v(" 2. 上传配置公钥")]),e("p",[s._v("生成秘钥对之后，我们需要将公钥上传到服务器对应账号的 home 路径下的.ssh/中，通过一下命令即可。")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("ssh-copy-id -i "),e("span",{attrs:{class:"token string"}},[s._v('"公钥文件名"')]),s._v(" 用户名@服务器ip或域名\n")])]),e("p",[s._v("上传完成之后，登录指定的服务器，进入到指定用户名下的 .ssh 文件夹之后，你会发现，其中有两个文件：")]),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/2/24/1691e9b7eb51593a?w=488&h=70&f=jpeg&s=21470",alt:""}})]),e("p",[s._v("通过 "),e("code",[s._v("cat authorized_keys")]),s._v("，会发现 authorized_keys 中已经存在你的公钥了。")]),e("p",[s._v("如果在中途遇到问题的话，我们可以登录服务器，将配置公钥文件 authorized_keys 访问权限设置为 600，然后再执行上面将公钥上传服务器的指令就可以了。")]),e("p",[s._v("通过一下命令可以修改权限：")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" 600 authorized_keys\n")])]),e("h2",{attrs:{id:"_3-配置本地秘钥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-配置本地秘钥","aria-hidden":"true"}},[s._v("#")]),s._v(" 3. 配置本地秘钥")]),e("p",[s._v("如果第一步中你是进入本机 home 目录下的 .ssh/ 文件夹执行的，那可以直接跨过这一步，如果不是需要按照说明执行这一步。")]),e("p",[s._v("把第一步生成的秘钥复制到你的 home 目录下的.ssh/ 路径下。可以通过 "),e("code",[s._v("mv XX_rsa ~/.ssh")]),s._v(" 命令，将生成的 "),e("code",[s._v("XX_rsa")]),s._v(" 文件进行移动。")]),e("p",[s._v("如果遇到问题，还是一样，可能权限不够，需要将你的秘钥文件访问权限设置为 600。")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{attrs:{class:"token function"}},[s._v("chmod")]),s._v(" 600 你的秘钥文件名\n")])]),e("h2",{attrs:{id:"_4-配置本地免密配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-配置本地免密配置文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 4. 配置本地免密配置文件")]),e("p",[s._v("秘钥对配置好之后，我们需要修改本地的免密配置文件。")]),e("p",[s._v("编辑自己 home 目录下的 .ssh/ 路径下的 config 文件，首先需要将 config 文件的访问权限设置为 644。")]),e("p",[s._v("其次通过 "),e("code",[s._v("vi")]),s._v(" 对配置文件进行操作。配置文件中可以配置多主机配置和单主机配置。多主机配置就是可以通过一个秘钥访问多个 linux 服务器，单主机的意思就不言而喻了，一个秘钥访问一个 linux 服务器。")]),e("p",[s._v("配置方式如下：")]),e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{attrs:{class:"token comment"}},[s._v("# 多主机配置")]),s._v("\n"),e("span",{attrs:{class:"token comment"}},[s._v("# 免密配置完成之后通过host机型登录，ssh 具体的Host")]),s._v("\nHost java-produce\n"),e("span",{attrs:{class:"token comment"}},[s._v("# 需要绑定到那个ip的linux服务器下")]),s._v("\nHostName IP或绑定的域名\n"),e("span",{attrs:{class:"token comment"}},[s._v("# 端口号")]),s._v("\nPort 22\n"),e("span",{attrs:{class:"token comment"}},[s._v("# 下面是另外一个主机的配置")]),s._v("\nHost node-produce\nHostName IP或绑定的域名\nPort 22\n\n"),e("span",{attrs:{class:"token comment"}},[s._v("# 上面主机的配置中凡是Host以-produce结尾的，都走下面的秘钥")]),s._v("\nHost *-produce\n"),e("span",{attrs:{class:"token comment"}},[s._v("# 登录的用户")]),s._v("\nUser root\n"),e("span",{attrs:{class:"token comment"}},[s._v("# 具体哪个秘钥文件，你本机的")]),s._v("\nIdentityFile ~/.ssh/produce_key_rsa\nProtocol 2\nCompression "),e("span",{attrs:{class:"token function"}},[s._v("yes")]),s._v("\nServerAliveInterval 60\nServerAliveCountMax 20\nLogLevel INFO\n\n"),e("span",{attrs:{class:"token comment"}},[s._v("# 单主机配置，具体某个字段什么意思和上面多主机一样")]),s._v("\n"),e("span",{attrs:{class:"token comment"}},[s._v("# 只不过不需要将主机和秘钥的配置分开，一起配置就行")]),s._v("\nHost evil-cloud\nUser root\nHostName IP或绑定的域名\nIdentityFile ~/.ssh/produce_key_rsa\nProtocol 2\nCompression "),e("span",{attrs:{class:"token function"}},[s._v("yes")]),s._v("\nServerAliveInterval 60\nServerAliveCountMax 20\nLogLevel INFO\n")])]),e("p",[s._v("配置完 config 文件之后，就可以通过 "),e("code",[s._v("ssh 配置的Host名称")]),s._v(" 访问具体的服务器了，不需要输入密码的哦。")])])}],!1,null,null,null);t.default=n.exports}}]);