(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{73:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"koa-小常识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#koa-小常识","aria-hidden":"true"}},[t._v("#")]),t._v(" Koa 小常识")]),a("p",[t._v("洋葱圈模型，当遇到 next 时，暂停当前函数，执行下一个中间件，当下游没有中间件执行时，将从最后一个中间件继续向上执行。")]),a("p",[a("img",{attrs:{src:"http://cdn.jinyueyue.cn/15504799167509.jpg",alt:""}})]),a("p",[t._v("绕过 koa 的 response 处理是不被支持的，应该注意不要使用一下 node 属性：")]),a("ul",[a("li",[t._v("res.statusCode")]),a("li",[t._v("res.writeHead()")]),a("li",[t._v("res.write()")]),a("li",[t._v("res.end()")])]),a("p",[t._v("koa 会根据 "),a("code",[t._v("ctx.body")]),t._v(" 返回值去自动更换"),a("code",[t._v("Content-Type")]),t._v("。")]),a("ul",[a("li",[a("code",[t._v("ctx.body = 111")])])]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Content"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("Type"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" application"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("json"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" charset"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("utf"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("8")]),t._v("\n")])]),a("p",[t._v("因为数字的 111 属于伪 json。")]),a("ul",[a("li",[a("code",[t._v("ctx.body = '111'")]),t._v(";")])]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Content"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("Type"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" text"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("plain"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" charset"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("utf"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("8")]),t._v("\n")])]),a("ul",[a("li",[a("code",[t._v("ctx.body = '<p>111</p>'")])])]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("Content"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("Type"),a("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" text"),a("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("html"),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" charset"),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("utf"),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("8")]),t._v("\n")])])])}],!1,null,null,null);s.default=n.exports}}]);